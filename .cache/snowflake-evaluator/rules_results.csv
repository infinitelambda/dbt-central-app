RULE_ID,RULE_ID__RULE_CATEGORY,RULE_ID__RULE_NAME,RULE_ID__RULE_DOC,RULE_ID__RULE_STATUS,RULE_ID__IDENTIFIERS,MET_DA_AGG_RESULTS_ALL
rule_warehouse_auto_suspend,Warehouse,"Warehouses can be set to automatically suspend when thereâ€™s no activity after a specified period of time. Auto-suspend is enabled by specifying the time period (minutes, hours, etc.) of inactivity for the warehouse. Snowflake recommends setting auto-suspend according to your workload and your requirements for warehouse availability: If you enable auto-suspend, we recommend setting it to a low value (e.g. 5 or 10 minutes or less) because Snowflake utilizes per-second billing. This will help keep your warehouses from running (and consuming credits) when not in use.",http://127.0.0.1:8000/snowflake-evaluator/Rules/Cost/warehouse_auto_suspend,PASS,,0
rule_user_disabled,User,ACCOUNT_USAGE view allows to get detailed info for users and their activity in the Snowflake account.,http://127.0.0.1:8000/snowflake-evaluator/Rules/Account/user_disabled,FAIL,MINCHOGANCHEV,1
rule_resource_monitor_account_monthly,ResourceMonitor,We suggest to setup a Resource Monitor with a monthly quota at account level.,http://127.0.0.1:8000/snowflake-evaluator/Rules/Cost/resource_monitor_account_monthly,FAIL,MONTHLY_MAX,1
rule_parameter_statement_timeout_in_seconds,Parameter,Cancel long queries after X hours. Most of the cases the default 48 hours looks too high.,http://127.0.0.1:8000/snowflake-evaluator/Rules/Account/parameter_statement_timeout_in_seconds,FAIL,"172800,172800",2
rule_warehouse_auto_resume,Warehouse,"Make sure all virtual warehouses are set to auto-resume. If you are going to implement auto-suspend and set appropriate timeout limits, enabling auto-resume is a must; otherwise, users will not be able to query the system.",http://127.0.0.1:8000/snowflake-evaluator/Rules/Cost/warehouse_auto_resume,PASS,,0
rule_accountadmin_default_role,User,Avoid to set ACCOUNTADMIN as a default role.,http://127.0.0.1:8000/snowflake-evaluator/Rules/Account/accountadmin_default_role,FAIL,"JASIM,MINCHOGANCHEV,RASTI,YANICAGEORGIEVA,VIKTORTRAYKOV,MILAN_S,NINA,TOMAS_J,NIKOLAYPETROV",9
rule_user_password_not_changed,User,"As a best practice, users should change their Snowflake password regularly. This rule allows to identify users who haven't changed their password for a specified time period (e.g. 180 days).",http://127.0.0.1:8000/snowflake-evaluator/Rules/Account/user_password_not_changed,FAIL,"JASIM,MINCHOGANCHEV,USER_BR_WAX_PROD_DBT,USER_BR_WAX_PROD_INGEST,BRIDGE_ADMIN,YANICAGEORGIEVA,VIKTORTRAYKOV,USER_BR_WAX_SNDB_DBT,USER_BR_WAX_PROD_LOOKER,USER_BR_WAX_DEV_LOOKER,MILAN_S,USER_BR_WAX_DEV_DBT,NINA,USER_BR_WAX_SNDB_LOOKER,USER_BR_WAX_DEV_INGEST,USER_BR_WAX_SNDB_INGEST,NIKOLAYPETROV,TOTI",18
rule_warehouse_resource_monitor_assignment,Warehouse,"To help control costs and avoid unexpected credit usage caused by running warehouses, Snowflake provides resource monitors. Monitor level property specifies whether the resource monitor is used to monitor the credit usage for your entire Account (i.e. all warehouses in the account) or a specific set of individual warehouses. Having a resource monitor set up for each virtual warehouse allows for regular monitoring of the credit consumption.",http://127.0.0.1:8000/snowflake-evaluator/Rules/Cost/warehouse_resource_monitor_assignment,FAIL,"WH_BR_MAINTENANCE,WH_BR_WAX_DEV_INGEST,WH_BR_WAX_DEV_REPORT,WH_BR_WAX_DEV_TRANSFORM,WH_BR_WAX_PROD_INGEST,WH_BR_WAX_PROD_REPORT,WH_BR_WAX_PROD_TRANSFORM,WH_BR_WAX_SNDB_INGEST,WH_BR_WAX_SNDB_REPORT,WH_BR_WAX_SNDB_TRANSFORM",10
rule_username_loginname,User,"As a best practice, username and login name values should be different for all users.",http://127.0.0.1:8000/snowflake-evaluator/Rules/Security/username_loginname,FAIL,"JASIM,MINCHOGANCHEV,USER_BR_WAX_PROD_DBT,USER_BR_WAX_PROD_INGEST,YENBUI,BRIDGE_ADMIN,RASTI,YANICAGEORGIEVA,VIKTORTRAYKOV,USER_BR_WAX_SNDB_DBT,USER_BR_WAX_PROD_LOOKER,USER_BR_WAX_DEV_LOOKER,MILAN_S,USER_BR_WAX_DEV_DBT,NINA,USER_BR_WAX_SNDB_LOOKER,USER_BR_WAX_DEV_INGEST,JINGYU_L,TOMAS_J,USER_BR_WAX_SNDB_INGEST,NIKOLAYPETROV,TOTI",22
rule_account_client_session_keep_alive,Parameter,"Check the parameter CLIENT_SESSION_KEEP_ALIVE , our recommendation is to keep the default value: FALSE.",http://127.0.0.1:8000/snowflake-evaluator/Rules/Account/account_client_session_keep_alive,PASS,,0
rule_network_restrict_access,NetworkPolicy,"By default, Snowflake allows users to connect to the service from any computer or device IP address. As a system administrator you can allow and deny access from addresses with network policies.",http://127.0.0.1:8000/snowflake-evaluator/Rules/Security/network_restrict_access,PASS,,0
rule_user_default_role_not_set,User,We suggest to setup a Resource Monitor with a monthly quota at account level.,http://127.0.0.1:8000/snowflake-evaluator/Rules/Account/user_default_role_not_set,PASS,,0
rule_account_statement_timeout,Parameter,This rule checks whether the two parameters (STATEMENT_QUEUED_TIMEOUT_IN_SECONDS and STATEMENT_TIMEOUT_IN_SECONDS) are in the interval between 0 and 1 day.,http://127.0.0.1:8000/snowflake-evaluator/Rules/Account/account_statement_timeout,FAIL,"0,172800",2
rule_custom_roles_granted_to_sysadmin,Object,"As a Snowflake best practice, functional roles in a role hierarchy should be granted to the system administrator (SYSADMIN) role. System administrators can then grant privileges on database objects to any roles in this hierarchy.",http://127.0.0.1:8000/snowflake-evaluator/Rules/Role/custom_roles_granted_to_sysadmin,FAIL,"ROLE_BR_WAX_DEV_RAW_RW,ROLE_BR_WAX_SNDB_RAW_R,ROLE_BR_WAX_PROD_RAW_RW,ROLE_BR_WAX_DEV_ANALYTICS_RW,ROLE_BR_WAX_DEV_ANALYTICS_R,ROLE_BR_WAX_DEV_REPORT,ROLE_BR_WAX_DEV_TRANSFORM,ROLE_BR_WAX_DATA_ENGINEERING,ROLE_BR_WAX_SNDB_ANALYTICS_R,ROLE_BR_WAX_PROD_RAW_R,ROLE_BR_WAX_PROD_ANALYTICS_R,ROLE_BRIDGE_ADMIN,ROLE_BR_WAX_SNDB_REPORT,ROLE_BR_WAX_DEV_INGEST,ROLE_BR_WAX_PROD_TRANSFORM,ROLE_BR_WAX_SNDB_TRANSFORM,ROLE_BR_WAX_SNDB_INGEST,ROLE_BR_WAX_PROD_REPORT,ROLE_BR_WAX_PROD_INGEST,ROLE_BR_WAX_DEV_RAW_R,ROLE_BR_WAX_SNDB_ANALYTICS_RW,ROLE_BR_WAX_PROD_ANALYTICS_RW,ROLE_BR_WAX_SNDB_RAW_RW",23
rule_accountadmin_created_objects,Object,Avoid Using the ACCOUNTADMIN Role to Create Objects.,http://127.0.0.1:8000/snowflake-evaluator/Rules/Account/accountadmin_created_objects,FAIL,"NINA,MINCHOGANCHEV,YANICAGEORGIEVA,NIKOLAYPETROV,MILAN_S,PUBLIC,TOTI,RASTI,TOMAS_J,VIKTORTRAYKOV,JASIM,FILEFORMAT,FILEFORMAT,PUBLIC,TEST2,TEST1,BR_WAX_DEV_ANALYTICS_20220810_1112CET",17
rule_parameter_timezone,Parameter,Snowflake uses America/Los Angeles as default timezone which can lead some strange issues.,http://127.0.0.1:8000/snowflake-evaluator/Rules/Account/parameter_timezone,FAIL,America/Los_Angeles,1
rule_accountadmin_mfa,User,All users assigned the ACCOUNTADMIN role should also be required to use multi-factor authentication (MFA) for login.,http://127.0.0.1:8000/snowflake-evaluator/Rules/Account/accountadmin_mfa,FAIL,"JASIM,MINCHOGANCHEV,YENBUI,RASTI,YANICAGEORGIEVA,VIKTORTRAYKOV,MILAN_S,NINA,JINGYU_L,TOMAS_J,NIKOLAYPETROV,TOTI",12
rule_parameter_data_retention_time_in_days,Parameter,Extend the default 1 day regarding Time Travel interval. Often not so much cost compare to the benefit it provides.,http://127.0.0.1:8000/snowflake-evaluator/Rules/Account/parameter_data_retention_time_in_days,PASS,,0
rule_warehouse_cloud_service_billing_threshold,Warehouse,"Overall for an account (and outside of serverless features), Snowflake will charge for cloud services only if they exceed 10% of the daily virtual warehouse credit consumption. The aim of this rule is to identify the warehouses which are contributing to the cloud service compute costs.",http://127.0.0.1:8000/snowflake-evaluator/Rules/Cost/warehouse_cloud_service_billing_threshold,FAIL,"WH_BR_WAX_DEV_REPORT,WH_BR_WAX_PROD_REPORT",2
rule_user_inactive,User,ACCOUNT_USAGE view allows to get detailed info for users and their activity in the Snowflake account.,http://127.0.0.1:8000/snowflake-evaluator/Rules/Account/user_inactive,FAIL,"USER_BR_WAX_PROD_DBT,RASTI,YANICAGEORGIEVA,USER_BR_WAX_SNDB_DBT,USER_BR_WAX_SNDB_LOOKER,USER_BR_WAX_SNDB_INGEST",6
rule_warehouse_credit_usage_spikes,Warehouse,This rule aims to identify warehouse credit usage that deviates from a pre-defined rule (e.g. daily credit consumption for the previous day exceeded the previous seven-day's credit consumption average at least four times).,http://127.0.0.1:8000/snowflake-evaluator/Rules/Cost/warehouse_credit_usage_spikes,PASS,,0
rule_date_time_column_type,Object,Choose an appropriate date or timestamp data type instead of varchar.,http://127.0.0.1:8000/snowflake-evaluator/Rules/Performance/date_time_column_type,FAIL,"DQ_ZEDK__PRODUCTS.LEAD_TIME,DQ_ZEDK__PRODUCTS.LEAD_TIME,DQ_ZEDK__PRODUCTS.LEAD_TIME,DQ_ZEDK__PRODUCTS.LEAD_TIME,WAX_CALENDAR.DATE,DQ_ZEDK__PRODUCTS.LEAD_TIME,DQ_ZEDK__PRODUCTS.LEAD_TIME,DQ_ZEDK__PRODUCTS.LEAD_TIME,DQ_ZEDK__PRODUCTS.LEAD_TIME,WAX_CALENDAR.DATE,DQ_ZEDK__PRODUCTS.LEAD_TIME",11
rule_user_default_warehouse_not_set,User,"As a best practice, all users should have a default warehouse which should correspond to their intended use of the Snowflake account.",http://127.0.0.1:8000/snowflake-evaluator/Rules/Account/user_default_warehouse_not_set,FAIL,"JASIM,MINCHOGANCHEV,BRIDGE_ADMIN,YANICAGEORGIEVA,VIKTORTRAYKOV,MILAN_S,NINA,TOMAS_J,NIKOLAYPETROV,TOTI",10
rule_accountadmin_email,User,"ACCOUNTADMIN user(s) should have email addresses, in case of Snowflake Support needs to contact with the client.",http://127.0.0.1:8000/snowflake-evaluator/Rules/Account/accountadmin_email,FAIL,"YENBUI,JINGYU_L",2
rule_accountadmin_at_least_2_users,User,Assign ACCOUNTADMIN role at least two users.,http://127.0.0.1:8000/snowflake-evaluator/Rules/Account/accountadmin_at_least_2_users,PASS,,0
